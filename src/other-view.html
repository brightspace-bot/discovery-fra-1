<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/d2l-search/d2l-search-input.html">
<link rel="import" href="../bower_components/d2l-alert/d2l-alert.html">
<link rel="import" href="../bower_components/d2l-datetime-picker/d2l-datetime-picker.html">
<link rel="import" href="../bower_components/d2l-tile/d2l-tile.html">
<link rel="import" href="components/search-header.html">

<dom-module id="other-view">
  <template>
    <style>
    </style>
  <search-header query={{query}}></search-header>
    <!-- <a name="discovery-home" href="[[rootPath]]discovery-home"><iron-icon icon="d2l-tier1:home"></iron-icon>Text</iron-icon></a>
    <d2l-search-input
        label="Search"
        value="{{query}}" 
        placeholder="What do you want to learn?"
    > -->

    <template is="dom-repeat" items="{{results}}">
      <d2l-tile href="#[[rootPath]]">[[item]]</d2l-tile>
    </template>
            
      
    hi
    [[info1]]
    <d2l-alert
    type="call-to-action"
    has-close-button
    button-text="Do it!"
    on-d2l-alert-button-pressed="_doSomething"
    on-d2l-alert-closed='_clearInfo'
    >
    Hello [[info1]]
    </d2l-alert>

    <d2l-datetime-picker
    locale="ar"
    timezone="America/Toronto"
    datetime="Wed Dec 31 1969 19:00:00 GMT-0500 (EST)",
    boundary='{"below":240}'
    ></d2l-datetime-picker>

    <a name="view1" href="#[[rootPath]]my-new-view">My New View</a>
    <div>
      <p>hi1</p>
    </div>
  </template>

  <script>
    // const supportsCustomElementsV1 = 'customElements' in window;
    // console.log('supportsCustomElementsV1:', supportsCustomElementsV1);
    class OtherView extends Polymer.Element {
      constructor() {
        super();
        this.addEventListener('info1-changed', () => {
          console.log('info1 changed to:', this.info1);
        });
      }
      static get is() {
        return 'other-view';
      }
      static get properties() {
        return {
          query: {
            type: String,
            value: '',
            observer: '_queryChanged'
          },
          results: {
            type: Array,
            value: [1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10],
            observer: '_resultsChanged'
          },
          info1: {
            type: String,
            notify: true,
            value: (() => 'default1'),
          },
        };
      }

      _queryChanged(newValue) {
        console.log('>> Begin search with query:', this.query);
        if (newValue) {
          this.push('results', newValue);
        }
        document.title = newValue;
      }

      _resultsChanged(newValue) {
        console.log('>> Rerender results:', this.results);
      }

      _clearInfo(e) {
        console.log(e);
        console.log('alert cleared');
        // console.log('actions:', App.ReduxMixin.actions);
        // this.dispatch(App.actions.clearInfo());
      }

      _doSomething(e) {
        console.log(e);
        console.log('alert clicked');
        // history.back();
        console.log('this.info1:', this.info1);
        this.info1='new value';
        this.query = 'new value!'
        // this.dispatch(App.actions.setInfo('hi!!!'));

        console.log('>> history:', history);
      }
    }

      window.customElements.define(OtherView.is, OtherView);
      window.customElements.whenDefined(OtherView.is).then(() => {
        console.log(`${OtherView.is} is ready`);
        // IFrau = window.IFrau || {};
        // console.log('>> what is window.IFrau:', IFrau);
        // console.log('>> what is window.IFrau.client:', IFrau.client);
        // document.documentElement.style.height = '500px';
      });
  </script>
</dom-module>
